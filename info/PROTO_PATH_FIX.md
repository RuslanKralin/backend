# –ö–æ–Ω—Å–ø–µ–∫—Ç: –ü—Ä–æ–±–ª–µ–º–∞ —Å –ø—É—Ç—è–º–∏ –∫ .proto —Ñ–∞–π–ª–∞–º –≤ npm –ø–∞–∫–µ—Ç–µ

## üìã –ß—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ?

–ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è `account.proto` –≤ –ø–∞–∫–µ—Ç `@ticket_for_cinema/contracts` –ø–µ—Ä–µ—Å—Ç–∞–ª —Ä–∞–±–æ—Ç–∞—Ç—å –∏–º–ø–æ—Ä—Ç `PROTO_PATH`, –∏ –ø—Ä–æ–µ–∫—Ç –Ω–µ –∑–∞–ø—É—Å–∫–∞–ª—Å—è.

## üîç –°—É—Ç—å –ø—Ä–æ–±–ª–µ–º—ã (–ø—Ä–æ—Å—Ç—ã–º–∏ —Å–ª–æ–≤–∞–º–∏)

–ü—Ä–µ–¥—Å—Ç–∞–≤—å, —á—Ç–æ —É —Ç–µ–±—è –µ—Å—Ç—å –¥–æ–º (npm –ø–∞–∫–µ—Ç), –∏ –≤ –Ω—ë–º –µ—Å—Ç—å –∫–æ–º–Ω–∞—Ç—ã –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —ç—Ç–∞–∂–∞—Ö:

```
–î–æ–º (@ticket_for_cinema/contracts)
‚îú‚îÄ‚îÄ 1 —ç—Ç–∞–∂ (dist/)
‚îÇ   ‚îî‚îÄ‚îÄ 2 —ç—Ç–∞–∂ (src/)
‚îÇ       ‚îî‚îÄ‚îÄ —Ç–≤–æ—è –∫–æ–º–Ω–∞—Ç–∞ (proto-paths.js) ‚Üê –¢–´ –ó–î–ï–°–¨
‚îî‚îÄ‚îÄ –ø–æ–¥–≤–∞–ª (proto/)
    ‚îú‚îÄ‚îÄ auth.proto
    ‚îî‚îÄ‚îÄ account.proto
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –¢—ã –Ω–∞—Ö–æ–¥–∏—à—å—Å—è –≤ –∫–æ–º–Ω–∞—Ç–µ –Ω–∞ 2 —ç—Ç–∞–∂–µ (`dist/src/`), –∏ –ø—ã—Ç–∞–µ—à—å—Å—è –Ω–∞–π—Ç–∏ –ø–æ–¥–≤–∞–ª —Å proto —Ñ–∞–π–ª–∞–º–∏.

### –ß—Ç–æ –±—ã–ª–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ:

```typescript
// ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û
join(__dirname, "..", "proto", "auth.proto");
```

–≠—Ç–æ –æ–∑–Ω–∞—á–∞–ª–æ:

- –¢—ã –Ω–∞ 2 —ç—Ç–∞–∂–µ (`dist/src/`)
- –ü–æ–¥–Ω–∏–º–∞–µ—à—å—Å—è –Ω–∞ 1 —É—Ä–æ–≤–µ–Ω—å –≤–≤–µ—Ä—Ö (`..`) ‚Üí –ø–æ–ø–∞–¥–∞–µ—à—å –Ω–∞ 1 —ç—Ç–∞–∂ (`dist/`)
- –ò—â–µ—à—å –ø–∞–ø–∫—É `proto` ‚Üí –∏—â–µ—à—å `dist/proto/` ‚Üê **–¢–ê–ö–û–ô –ü–ê–ü–ö–ò –ù–ï–¢!**

### –ß—Ç–æ —Å—Ç–∞–ª–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ:

```typescript
// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û
join(__dirname, "..", "..", "proto", "auth.proto");
```

–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç:

- –¢—ã –Ω–∞ 2 —ç—Ç–∞–∂–µ (`dist/src/`)
- –ü–æ–¥–Ω–∏–º–∞–µ—à—å—Å—è –Ω–∞ 1 —É—Ä–æ–≤–µ–Ω—å –≤–≤–µ—Ä—Ö (`..`) ‚Üí 1 —ç—Ç–∞–∂ (`dist/`)
- –ü–æ–¥–Ω–∏–º–∞–µ—à—å—Å—è –µ—â—ë –Ω–∞ 1 —É—Ä–æ–≤–µ–Ω—å –≤–≤–µ—Ä—Ö (`..`) ‚Üí –≤—ã—Ö–æ–¥–∏—à—å –∏–∑ –¥–æ–º–∞ (–∫–æ—Ä–µ–Ω—å –ø–∞–∫–µ—Ç–∞)
- –°–ø—É—Å–∫–∞–µ—à—å—Å—è –≤ –ø–æ–¥–≤–∞–ª ‚Üí –Ω–∞—Ö–æ–¥–∏—à—å `proto/auth.proto` ‚Üê **–ï–°–¢–¨!** ‚úÖ

## üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–∞–∫–µ—Ç–∞

–ö–æ–≥–¥–∞ —Ç—ã –ø—É–±–ª–∏–∫—É–µ—à—å –ø–∞–∫–µ—Ç –≤ npm, –æ–Ω –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫:

```
node_modules/@ticket_for_cinema/contracts/
‚îú‚îÄ‚îÄ dist/
‚îÇ   ‚îú‚îÄ‚îÄ gen/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ account.js
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ auth.js
‚îÇ   ‚îî‚îÄ‚îÄ src/
‚îÇ       ‚îú‚îÄ‚îÄ index.js          ‚Üê —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ (main –≤ package.json)
‚îÇ       ‚îî‚îÄ‚îÄ proto-paths.js    ‚Üê __dirname —É–∫–∞–∑—ã–≤–∞–µ—Ç –°–Æ–î–ê
‚îú‚îÄ‚îÄ proto/
‚îÇ   ‚îú‚îÄ‚îÄ auth.proto           ‚Üê –Ω—É–∂–Ω–æ –Ω–∞–π—Ç–∏ —ç—Ç–∏ —Ñ–∞–π–ª—ã
‚îÇ   ‚îî‚îÄ‚îÄ account.proto
‚îú‚îÄ‚îÄ gen/
‚îÇ   ‚îú‚îÄ‚îÄ account.ts
‚îÇ   ‚îî‚îÄ‚îÄ auth.ts
‚îî‚îÄ‚îÄ package.json
```

## üõ†Ô∏è –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### 1. –§–∞–π–ª: `contracts/src/proto-paths.ts`

**–ë—ã–ª–æ:**

```typescript
export const PROTO_PATH = {
  AUTH: join(__dirname, "..", "proto", "auth.proto"),
  ACCOUNT: join(__dirname, "..", "proto", "account.proto"),
};
```

**–°—Ç–∞–ª–æ:**

```typescript
export const PROTO_PATH = {
  AUTH: join(__dirname, "..", "..", "proto", "auth.proto"),
  ACCOUNT: join(__dirname, "..", "..", "proto", "account.proto"),
};
```

### 2. –§–∞–π–ª: `contracts/package.json`

–£–±–µ–¥–∏–ª–∏—Å—å, —á—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —É–∫–∞–∑–∞–Ω—ã —Ç–æ—á–∫–∏ –≤—Ö–æ–¥–∞:

```json
{
  "main": "dist/src/index.js",
  "types": "dist/src/index.d.ts"
}
```

## üéØ –ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ?

### –í –ø—Ä–æ—Ü–µ—Å—Å–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (–ª–æ–∫–∞–ª—å–Ω–æ):

- –§–∞–π–ª—ã –ª–µ–∂–∞—Ç –≤ –ø–∞–ø–∫–µ `contracts/src/`
- `__dirname` —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ `contracts/src/`
- –ü—É—Ç—å `join(__dirname, "..", "proto")` —Ä–∞–±–æ—Ç–∞–µ—Ç ‚Üí `contracts/proto/` ‚úÖ

### –ü–æ—Å–ª–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –≤ npm:

- –§–∞–π–ª—ã –∫–æ–º–ø–∏–ª–∏—Ä—É—é—Ç—Å—è –≤ `dist/src/`
- `__dirname` —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ `node_modules/@ticket_for_cinema/contracts/dist/src/`
- –ù—É–∂–Ω–æ –ø–æ–¥–Ω—è—Ç—å—Å—è –Ω–∞ 2 —É—Ä–æ–≤–Ω—è –≤–≤–µ—Ä—Ö, —á—Ç–æ–±—ã –Ω–∞–π—Ç–∏ `proto/`

## üìù –ü–æ—à–∞–≥–æ–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ

1. **–ò–∑–º–µ–Ω–∏–ª–∏ –ø—É—Ç—å** –≤ `proto-paths.ts` (–¥–æ–±–∞–≤–∏–ª–∏ –µ—â—ë –æ–¥–∏–Ω `".."`)
2. **–£–≤–µ–ª–∏—á–∏–ª–∏ –≤–µ—Ä—Å–∏—é** –≤ `package.json` (1.0.12 ‚Üí 1.0.13)
3. **–ó–∞–∫–æ–º–º–∏—Ç–∏–ª–∏ –∏ –∑–∞–ø—É—à–∏–ª–∏** –∏–∑–º–µ–Ω–µ–Ω–∏—è
4. **CI/CD –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–ª** –Ω–æ–≤—É—é –≤–µ—Ä—Å–∏—é –≤ npm
5. **–û–±–Ω–æ–≤–∏–ª–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å** –≤ gateway-service: `yarn add @ticket_for_cinema/contracts@latest`
6. **–ü—Ä–æ–µ–∫—Ç –∑–∞—Ä–∞–±–æ—Ç–∞–ª!** üéâ

## üí° –í–∞–∂–Ω—ã–π —É—Ä–æ–∫

–ö–æ–≥–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—à—å —Å npm –ø–∞–∫–µ—Ç–∞–º–∏, –∫–æ—Ç–æ—Ä—ã–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É—é—Ç –ø—É—Ç–∏ –∫ —Ñ–∞–π–ª–∞–º:

1. **–ü–æ–º–Ω–∏ –æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –ø–æ—Å–ª–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏** - –æ–Ω–∞ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç –∏—Å—Ö–æ–¥–Ω–æ–π
2. **–ò—Å–ø–æ–ª—å–∑—É–π `__dirname` –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ** - –æ–Ω —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–∞–π–ª, –∞ –Ω–µ –Ω–∞ –∏—Å—Ö–æ–¥–Ω—ã–π
3. **–¢–µ—Å—Ç–∏—Ä—É–π –ø–∞–∫–µ—Ç –ø–æ—Å–ª–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏** - –ª–æ–∫–∞–ª—å–Ω–æ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å, –∞ –≤ npm - –Ω–µ—Ç

## üîß –ö–∞–∫ –∏–∑–±–µ–∂–∞—Ç—å –≤ –±—É–¥—É—â–µ–º?

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ò–∑–º–µ–Ω–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–æ–º–ø–∏–ª—è—Ü–∏–∏

–í `tsconfig.build.json` –¥–æ–±–∞–≤–∏—Ç—å `rootDir`:

```json
{
  "compilerOptions": {
    "outDir": "./dist",
    "rootDir": "./src"  ‚Üê –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç src/ –ø—Ä—è–º–æ –≤ dist/
  }
}
```

–¢–æ–≥–¥–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –±—É–¥–µ—Ç:

```
dist/
‚îú‚îÄ‚îÄ index.js
‚îî‚îÄ‚îÄ proto-paths.js
```

–ò –ø—É—Ç—å –±—É–¥–µ—Ç: `join(__dirname, "..", "proto")`

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–±—Å–æ–ª—é—Ç–Ω—ã–µ –ø—É—Ç–∏ –æ—Ç package root

```typescript
import { resolve } from "path";

// –ù–∞–π—Ç–∏ –∫–æ—Ä–µ–Ω—å –ø–∞–∫–µ—Ç–∞
const packageRoot = resolve(__dirname, "..", "..");

export const PROTO_PATH = {
  AUTH: resolve(packageRoot, "proto", "auth.proto"),
  ACCOUNT: resolve(packageRoot, "proto", "account.proto"),
};
```

## ‚úÖ –ò—Ç–æ–≥

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø—É—Ç—å –∫ proto —Ñ–∞–π–ª–∞–º –≤ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω–æ–º npm –ø–∞–∫–µ—Ç–µ.

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏–ª–∏ –µ—â—ë –æ–¥–∏–Ω —É—Ä–æ–≤–µ–Ω—å –ø–æ–¥—ä—ë–º–∞ –≤–≤–µ—Ä—Ö (`".."`) –≤ –ø—É—Ç—è—Ö, —á—Ç–æ–±—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞–π—Ç–∏ –ø–∞–ø–∫—É `proto/` –∏–∑ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–æ–¥–∞ –≤ `dist/src/`.

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü—Ä–æ–µ–∫—Ç —É—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è, proto —Ñ–∞–π–ª—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ! üöÄ
