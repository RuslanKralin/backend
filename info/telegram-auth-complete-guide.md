# üéØ –ü–æ–ª–Ω—ã–π –ö–æ–Ω—Å–ø–µ–∫—Ç: –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Telegram

## üìñ –ß—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ –ø—Ä–æ—Å—Ç—ã–º–∏ —Å–ª–æ–≤–∞–º–∏

**–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Telegram** - —ç—Ç–æ —Å–ø–æ—Å–æ–± –≤–æ–π—Ç–∏ –Ω–∞ —Å–∞–π—Ç –∏—Å–ø–æ–ª—å–∑—É—è —Å–≤–æ–π Telegram –∞–∫–∫–∞—É–Ω—Ç, –∫–∞–∫ "–í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Google" –∏–ª–∏ "–í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Facebook".

**–ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ:**

- ‚úÖ –ù–µ –Ω—É–∂–Ω–æ –∑–∞–ø–æ–º–∏–Ω–∞—Ç—å –ø–∞—Ä–æ–ª–∏
- ‚úÖ –ë—ã—Å—Ç—Ä–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è (1 –∫–ª–∏–∫)
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ (Telegram –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –≤—ã)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞–µ–º –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

–í –≤–∞—à–µ–º –ø—Ä–æ–µ–∫—Ç–µ **3 —Å–µ—Ä–≤–∏—Å–∞**:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Frontend  ‚îÇ ‚îÄ‚îÄ‚îÄ‚ñ∫ ‚îÇ   Gateway    ‚îÇ ‚îÄ‚îÄ‚îÄ‚ñ∫ ‚îÇ    Auth     ‚îÇ
‚îÇ  (–ë—Ä–∞—É–∑–µ—Ä)  ‚îÇ      ‚îÇ   Service    ‚îÇ      ‚îÇ   Service   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                                   ‚îÇ
                                                   ‚ñº
                                            ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                                            ‚îÇ Bot Service ‚îÇ
                                            ‚îÇ  (Telegram) ‚îÇ
                                            ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–†–æ–ª–∏ —Å–µ—Ä–≤–∏—Å–æ–≤:**

- **Frontend** - –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∫–Ω–æ–ø–∫–∞ "–í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Telegram")
- **Gateway Service** - –ø—Ä–∏–Ω–∏–º–∞–µ—Ç HTTP –∑–∞–ø—Ä–æ—Å—ã –æ—Ç —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
- **Auth Service** - –æ—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏, —Ä–∞–±–æ—Ç–∞ —Å –ë–î
- **Bot Service** - Telegram –±–æ—Ç –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞

---

## üîÑ –î–≤–∞ —Å—Ü–µ–Ω–∞—Ä–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

### **–°—Ü–µ–Ω–∞—Ä–∏–π 1: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –£–ñ–ï —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª—Å—è (–µ—Å—Ç—å –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞)**

```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Üí –°–∞–π—Ç: "–•–æ—á—É –≤–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Telegram"
2. –°–∞–π—Ç ‚Üí Telegram OAuth: "–ü—Ä–æ–≤–µ—Ä—å —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"
3. Telegram ‚Üí –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: "–†–∞–∑—Ä–µ—à–∏—Ç—å –¥–æ—Å—Ç—É–ø?"
4. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Üí Telegram: "–î–∞, —Ä–∞–∑—Ä–µ—à–∞—é"
5. Telegram ‚Üí –°–∞–π—Ç: "–í–æ—Ç –¥–∞–Ω–Ω—ã–µ + –ø–æ–¥–ø–∏—Å—å (hash)"
6. –°–∞–π—Ç ‚Üí Auth Service: "–ü—Ä–æ–≤–µ—Ä—å –ø–æ–¥–ø–∏—Å—å –∏ –Ω–∞–π–¥–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"
7. Auth Service: "–ü–æ–¥–ø–∏—Å—å OK! –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–π–¥–µ–Ω, –µ—Å—Ç—å —Ç–µ–ª–µ—Ñ–æ–Ω!"
8. Auth Service ‚Üí –°–∞–π—Ç: "–í–æ—Ç —Ç–æ–∫–µ–Ω—ã (accessToken + refreshToken)"
9. –°–∞–π—Ç: "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω! ‚úÖ"
```

### **–°—Ü–µ–Ω–∞—Ä–∏–π 2: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ù–û–í–´–ô (–Ω–µ—Ç –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞)**

```
1-6. [–¢–µ –∂–µ —à–∞–≥–∏, —á—Ç–æ –∏ –≤ –°—Ü–µ–Ω–∞—Ä–∏–∏ 1]
7. Auth Service: "–ü–æ–¥–ø–∏—Å—å OK! –ù–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ—Ç –∏–ª–∏ –Ω–µ—Ç —Ç–µ–ª–µ—Ñ–æ–Ω–∞"
8. Auth Service ‚Üí Redis: "–°–æ—Ö—Ä–∞–Ω—è—é –≤—Ä–µ–º–µ–Ω–Ω—É—é —Å–µ—Å—Å–∏—é (sessionId + telegramId)"
9. Auth Service ‚Üí –°–∞–π—Ç: "–í–æ—Ç —Å—Å—ã–ª–∫–∞ –Ω–∞ –±–æ—Ç–∞: t.me/bot?start=SESSION_ID"
10. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Üí Telegram Bot: –ü–µ—Ä–µ—Ö–æ–¥–∏—Ç –ø–æ —Å—Å—ã–ª–∫–µ
11. Bot: "–û—Ç–ø—Ä–∞–≤—å —Å–≤–æ–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞"
12. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Üí Bot: –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–æ–º–µ—Ä
13. Bot ‚Üí Auth Service: "–í–æ—Ç –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –¥–ª—è SESSION_ID"
14. Auth Service: "–°–æ–∑–¥–∞—é/–æ–±–Ω–æ–≤–ª—è—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –ø—Ä–∏–≤—è–∑—ã–≤–∞—é telegramId"
15. Auth Service ‚Üí Redis: "–°–æ—Ö—Ä–∞–Ω—è—é —Ç–æ–∫–µ–Ω—ã –¥–ª—è SESSION_ID"
16. Bot ‚Üí –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: "‚úÖ –ì–æ—Ç–æ–≤–æ! –í–µ—Ä–Ω–∏—Å—å –Ω–∞ —Å–∞–π—Ç"
17. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Üí –°–∞–π—Ç: –ü–µ—Ä–µ—Ö–æ–¥–∏—Ç –ø–æ —Å—Å—ã–ª–∫–µ —Å SESSION_ID
18. –°–∞–π—Ç ‚Üí Auth Service: "–î–∞–π —Ç–æ–∫–µ–Ω—ã –¥–ª—è SESSION_ID"
19. Auth Service ‚Üí –°–∞–π—Ç: "–í–æ—Ç —Ç–æ–∫–µ–Ω—ã!"
20. –°–∞–π—Ç: "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω! ‚úÖ"
```

---

## üîê –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### **Telegram OAuth - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏ (hash)**

–ö–æ–≥–¥–∞ Telegram –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –æ–Ω –¥–æ–±–∞–≤–ª—è–µ—Ç **hash** (–ø–æ–¥–ø–∏—Å—å):

```javascript
// –î–∞–Ω–Ω—ã–µ –æ—Ç Telegram:
{
  id: "525366794",
  first_name: "Ruslan",
  username: "Ruslan_Kralin",
  hash: "abc123def456..."  // ‚Üê –ü–æ–¥–ø–∏—Å—å
}
```

**–ö–∞–∫ —Å–æ–∑–¥–∞–µ—Ç—Å—è –ø–æ–¥–ø–∏—Å—å:**

1. Telegram –±–µ—Ä–µ—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ (–∫—Ä–æ–º–µ hash)
2. –°–æ—Ä—Ç–∏—Ä—É–µ—Ç –∏—Ö –ø–æ –∞–ª—Ñ–∞–≤–∏—Ç—É
3. –°–æ–∑–¥–∞–µ—Ç —Å—Ç—Ä–æ–∫—É: `first_name=Ruslan\nid=525366794\nusername=Ruslan_Kralin`
4. –®–∏—Ñ—Ä—É–µ—Ç —ç—Ç—É —Å—Ç—Ä–æ–∫—É —Å –ø–æ–º–æ—â—å—é **—Å–µ–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞** (bot_token)
5. –ü–æ–ª—É—á–∞–µ—Ç hash

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:**

```typescript
// Auth Service –¥–µ–ª–∞–µ—Ç —Ç–æ –∂–µ —Å–∞–º–æ–µ:
const dataCheckStr = "first_name=Ruslan\nid=525366794\nusername=Ruslan_Kralin";
const secretKey = sha256(`${BOT_ID}:${BOT_TOKEN}`);
const hmac = HMAC_SHA256(secretKey, dataCheckStr);

if (hmac === hash) {
  // ‚úÖ –ü–æ–¥–ø–∏—Å—å –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è, –¥–∞–Ω–Ω—ã–µ –Ω–µ –ø–æ–¥–¥–µ–ª–∞–Ω—ã
} else {
  // ‚ùå –ü–æ–¥–ø–∏—Å—å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è, –∫—Ç–æ-—Ç–æ –ø—ã—Ç–∞–µ—Ç—Å—è –æ–±–º–∞–Ω—É—Ç—å
}
```

**–ü–æ—á–µ–º—É —ç—Ç–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ:**

- ‚ùå –ù–µ–ª—å–∑—è –ø–æ–¥–¥–µ–ª–∞—Ç—å –¥–∞–Ω–Ω—ã–µ - –∏–∑–º–µ–Ω–∏—Ç—Å—è hash
- ‚ùå –ù–µ–ª—å–∑—è —Å–æ–∑–¥–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π hash - –Ω—É–∂–µ–Ω bot_token (—Ç–æ–ª—å–∫–æ —É –≤–∞—Å –∏ Telegram)
- ‚ùå –ù–µ–ª—å–∑—è –ø–µ—Ä–µ—Ö–≤–∞—Ç–∏—Ç—å –∏ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –≤—Ä–µ–º—è (auth_date)

---

## üì¶ –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ Redis

**Redis** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è —Å–≤—è–∑–∏ –º–µ–∂–¥—É —à–∞–≥–∞–º–∏:

### **–ö–ª—é—á 1: `telegram_session:SESSION_ID`**

```json
{
  "telegramId": "525366794",
  "username": "Ruslan_Kralin"
}
```

- **–ö–æ–≥–¥–∞ —Å–æ–∑–¥–∞–µ—Ç—Å—è:** –ü–æ—Å–ª–µ Telegram OAuth, –µ—Å–ª–∏ –Ω—É–∂–µ–Ω –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞
- **–°—Ä–æ–∫ –∂–∏–∑–Ω–∏:** 5 –º–∏–Ω—É—Ç (300 —Å–µ–∫—É–Ω–¥)
- **–î–ª—è —á–µ–≥–æ:** –°–≤—è–∑–∞—Ç—å telegramId —Å –Ω–æ–º–µ—Ä–æ–º —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –∏–∑ –±–æ—Ç–∞

### **–ö–ª—é—á 2: `telegram_tokens:SESSION_ID`**

```json
{
  "accessToken": "eyJhbGc...",
  "refreshToken": "eyJhbGc..."
}
```

- **–ö–æ–≥–¥–∞ —Å–æ–∑–¥–∞–µ—Ç—Å—è:** –ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –≤ –±–æ—Ç–µ
- **–°—Ä–æ–∫ –∂–∏–∑–Ω–∏:** 2 –º–∏–Ω—É—Ç—ã (120 —Å–µ–∫—É–Ω–¥)
- **–î–ª—è —á–µ–≥–æ:** –ü–µ—Ä–µ–¥–∞—Ç—å —Ç–æ–∫–µ–Ω—ã –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ —á–µ—Ä–µ–∑ —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å

---

## üîå API Endpoints (Gateway Service)

### **1. GET `/auth/telegram`**

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Å—ã–ª–∫—É –Ω–∞ Telegram OAuth

**–ó–∞–ø—Ä–æ—Å:**

```http
GET /auth/telegram
```

**–û—Ç–≤–µ—Ç:**

```json
{
  "url": "https://oauth.telegram.org/auth?bot_id=123&origin=https://site.com&..."
}
```

**–§—Ä–æ–Ω—Ç–µ–Ω–¥:** –û—Ç–∫—Ä—ã–≤–∞–µ—Ç —ç—Ç—É —Å—Å—ã–ª–∫—É –≤ –Ω–æ–≤–æ–º –æ–∫–Ω–µ

---

### **2. POST `/auth/telegram/verify`**

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –æ—Ç Telegram OAuth

**–ó–∞–ø—Ä–æ—Å:**

```json
{
  "tgAuthResult": "base64_encoded_data"
}
```

**–û—Ç–≤–µ—Ç (–µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –µ—Å—Ç—å):**

```json
{
  "accessToken": "eyJhbGc..."
}
```

- Cookie: `refreshToken`

**–û—Ç–≤–µ—Ç (–µ—Å–ª–∏ –Ω—É–∂–µ–Ω –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞):**

```json
{
  "url": "http://t.me/bot?start=abc123def456"
}
```

**–§—Ä–æ–Ω—Ç–µ–Ω–¥:**

- –ï—Å–ª–∏ —Ç–æ–∫–µ–Ω ‚Üí —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏ –∞–≤—Ç–æ—Ä–∏–∑—É–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ï—Å–ª–∏ URL ‚Üí –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–Ω–æ–ø–∫—É "–ü–µ—Ä–µ–π—Ç–∏ –≤ Telegram"

---

### **3. POST `/auth/telegram/finalize`**

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –ü–æ–ª—É—á–∞–µ—Ç —Ç–æ–∫–µ–Ω—ã –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –≤ –±–æ—Ç–µ

**–ó–∞–ø—Ä–æ—Å:**

```json
{
  "sessionId": "abc123def456"
}
```

**–û—Ç–≤–µ—Ç:**

```json
{
  "accessToken": "eyJhbGc..."
}
```

- Cookie: `refreshToken`

**–§—Ä–æ–Ω—Ç–µ–Ω–¥:** –í—ã–∑—ã–≤–∞–µ—Ç –ø–æ—Å–ª–µ –≤–æ–∑–≤—Ä–∞—Ç–∞ —Å –±–æ—Ç–∞ (–∏–∑ URL –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `?session_id=...`)

---

## ü§ñ Telegram Bot (Bot Service)

### **–ö–æ–º–∞–Ω–¥–∞ `/start SESSION_ID`**

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**

```typescript
bot.start(async (ctx) => {
  const sessionId = ctx.startPayload; // "abc123def456"

  // –°–æ—Ö—Ä–∞–Ω—è–µ–º sessionId –≤ —Å–µ—Å—Å–∏—é –±–æ—Ç–∞
  ctx.session.id = sessionId;

  // –ü—Ä–æ—Å–∏–º –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞
  await ctx.reply(
    "–î–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–≤–æ–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞",
    Markup.keyboard([[Markup.button.contactRequest("–û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–æ–º–µ—Ä")]]),
  );
});
```

**–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç:** –ö–Ω–æ–ø–∫—É "–û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–æ–º–µ—Ä"

---

### **–ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞**

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**

```typescript
bot.on("contact", async (ctx) => {
  const phone = ctx.message.contact.phone_number; // "+375297888192"
  const sessionId = ctx.session.id; // "abc123def456"

  // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ Auth Service —á–µ—Ä–µ–∑ gRPC
  const response = await authClient.telegramComplete({
    sessionId,
    phone,
  });

  // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –≤–æ–∑–≤—Ä–∞—Ç–∞ –Ω–∞ —Å–∞–π—Ç
  await ctx.reply("‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞!", {
    reply_markup: {
      inline_keyboard: [
        [
          {
            text: "–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ —Å–∞–π—Ç",
            url: `https://site.com/auth/tg-finalize?session_id=${sessionId}`,
          },
        ],
      ],
    },
  });
});
```

**–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç:** –°–æ–æ–±—â–µ–Ω–∏–µ —Å –∫–Ω–æ–ø–∫–æ–π "–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ —Å–∞–π—Ç"

---

## üîß gRPC –º–µ—Ç–æ–¥—ã (Auth Service)

### **1. TelegramInit**

```protobuf
rpc TelegramInit(Empty) returns (TelegramInitResponse);
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç URL –¥–ª—è Telegram OAuth

**–ö–æ–¥:**

```typescript
public getAuthUrl(): TelegramInitResponse {
  const url = new URL(`https://oauth.telegram.org/auth`);
  url.searchParams.append("bot_id", this.BOT_ID);
  url.searchParams.append("origin", this.REDIRECT_ORIGIN);
  url.searchParams.append("request_access", "write");
  url.searchParams.append("return_to", this.REDIRECT_ORIGIN);

  return { url: url.href };
}
```

---

### **2. TelegramVerify**

```protobuf
rpc TelegramVerify(TelegramVerifyRequest) returns (TelegramVerifyResponse);
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–ø–∏—Å—å –∏ —Ä–µ—à–∞–µ—Ç, —á—Ç–æ –¥–µ–ª–∞—Ç—å –¥–∞–ª—å—à–µ

**–ö–æ–¥:**

```typescript
public async verify(data: TelegramVerifyRequest) {
  // 1. –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–ø–∏—Å—å
  const isAuthValid = this.checkTelegramAuth(data.query);
  if (!isAuthValid) {
    throw new RpcException({ message: "Invalid Telegram auth" });
  }

  // 2. –ò—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  const telegramId = data.query.id;
  const existingUser = await this.telegramRepository.findUserByTelegramId(telegramId);

  // 3. –ï—Å–ª–∏ –µ—Å—Ç—å –∏ —Å —Ç–µ–ª–µ—Ñ–æ–Ω–æ–º ‚Üí –≤—ã–¥–∞–µ–º —Ç–æ–∫–µ–Ω—ã
  if (existingUser && existingUser.phone) {
    return this.tokenService.generateTokens(existingUser.id);
  }

  // 4. –ï—Å–ª–∏ –Ω–µ—Ç –∏–ª–∏ –±–µ–∑ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ ‚Üí —Å–æ–∑–¥–∞–µ–º —Å–µ—Å—Å–∏—é –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ –±–æ—Ç–∞
  const sessionId = randomBytes(16).toString("hex");
  await this.redisService.set(
    `telegram_session:${sessionId}`,
    JSON.stringify({ telegramId, username: data.query.username }),
    "EX",
    300
  );

  return { url: `http://t.me/${this.BOT_USERNAME}?start=${sessionId}` };
}
```

---

### **3. TelegramComplete**

```protobuf
rpc TelegramComplete(TelegramCompleteRequest) returns (TelegramCompleteResponse);
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –ü–æ–ª—É—á–∞–µ—Ç –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –æ—Ç –±–æ—Ç–∞ –∏ —Å–æ–∑–¥–∞–µ—Ç/–æ–±–Ω–æ–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–ö–æ–¥:**

```typescript
public async complete(data: TelegramCompleteRequest) {
  const { sessionId, phone } = data;

  // 1. –î–æ—Å—Ç–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ Redis
  const raw = await this.redisService.get(`telegram_session:${sessionId}`);
  if (!raw) throw new RpcException({ message: "Invalid session" });

  const { telegramId } = JSON.parse(raw);

  // 2. –ò—â–µ–º –∏–ª–∏ —Å–æ–∑–¥–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É
  let existingUser = await this.userRepo.findUserByPhone(phone);
  if (!existingUser) {
    existingUser = await this.userRepo.createAccount({ phone });
  }

  // 3. –ü—Ä–∏–≤—è–∑—ã–≤–∞–µ–º telegramId –∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
  await this.userRepo.updateAccount(existingUser.id, {
    telegramId,
    isPhoneVerified: true
  });

  // 4. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ç–æ–∫–µ–Ω—ã –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤ Redis
  const tokens = this.tokenService.generateTokens(existingUser.id);
  await this.redisService.set(
    `telegram_tokens:${sessionId}`,
    JSON.stringify(tokens),
    "EX",
    120
  );

  // 5. –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—É—é —Å–µ—Å—Å–∏—é
  await this.redisService.del(`telegram_session:${sessionId}`);

  return { sessionId };
}
```

---

### **4. TelegramConsume**

```protobuf
rpc TelegramConsume(TelegramConsumeRequest) returns (TelegramConsumeResponse);
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –û—Ç–¥–∞–µ—Ç —Ç–æ–∫–µ–Ω—ã —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—É –∏ —É–¥–∞–ª—è–µ—Ç –∏—Ö –∏–∑ Redis

**–ö–æ–¥:**

```typescript
public async consumeSession(data: TelegramConsumeRequest) {
  const { sessionId } = data;

  // 1. –î–æ—Å—Ç–∞–µ–º —Ç–æ–∫–µ–Ω—ã –∏–∑ Redis
  const raw = await this.redisService.get(`telegram_tokens:${sessionId}`);
  if (!raw) throw new RpcException({ message: "Invalid session" });

  const tokens = JSON.parse(raw);

  // 2. –£–¥–∞–ª—è–µ–º —Ç–æ–∫–µ–Ω—ã (–æ–¥–Ω–æ—Ä–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ)
  await this.redisService.del(`telegram_tokens:${sessionId}`);

  return tokens;
}
```

---

## üìã –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –ù–û–í–û–ì–û –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### **–®–∞–≥ 1: –§—Ä–æ–Ω—Ç–µ–Ω–¥ - –ó–∞–ø—Ä–æ—Å OAuth URL**

```javascript
// –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∞–ª "–í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Telegram"
const response = await fetch("http://localhost:3000/auth/telegram");
const { url } = await response.json();

// –û—Ç–∫—Ä—ã–≤–∞–µ–º Telegram OAuth –≤ –Ω–æ–≤–æ–º –æ–∫–Ω–µ
window.open(url, "_blank");
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–∞ –±—ç–∫–µ–Ω–¥–µ:**

- Gateway ‚Üí Auth Service: `TelegramInit()`
- Auth Service ‚Üí Gateway: `{ url: "https://oauth.telegram.org/auth?..." }`

---

### **–®–∞–≥ 2: Telegram OAuth - –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è**

```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç: "–†–∞–∑—Ä–µ—à–∏—Ç—å –¥–æ—Å—Ç—É–ø –¥–ª—è bot?"
2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç: "–†–∞–∑—Ä–µ—à–∏—Ç—å"
3. Telegram –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞: https://site.com#tgAuthResult=base64_data
```

---

### **–®–∞–≥ 3: –§—Ä–æ–Ω—Ç–µ–Ω–¥ - –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Å–µ—Ä–≤–µ—Ä**

```javascript
// –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ URL
const hash = window.location.hash;
const tgAuthResult = new URLSearchParams(hash.slice(1)).get("tgAuthResult");

// –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä
const response = await fetch("http://localhost:3000/auth/telegram/verify", {
  method: "POST",
  headers: { "Content-Type": "application/json" },
  body: JSON.stringify({ tgAuthResult }),
});

const result = await response.json();

if (result.url) {
  // –ù—É–∂–µ–Ω –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É
  showButton("–ü–µ—Ä–µ–π—Ç–∏ –≤ Telegram", result.url);
} else if (result.accessToken) {
  // –£–∂–µ –µ—Å—Ç—å - –∞–≤—Ç–æ—Ä–∏–∑—É–µ–º
  localStorage.setItem("accessToken", result.accessToken);
  redirectToHome();
}
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–∞ –±—ç–∫–µ–Ω–¥–µ:**

- Gateway: –î–µ–∫–æ–¥–∏—Ä—É–µ—Ç `tgAuthResult` –∏–∑ base64
- Gateway ‚Üí Auth Service: `TelegramVerify({ query: {...} })`
- Auth Service: –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–ø–∏—Å—å ‚úÖ
- Auth Service: –ò—â–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ‚Üí –ù–ï –ù–ê–ô–î–ï–ù –∏–ª–∏ –ë–ï–ó –¢–ï–õ–ï–§–û–ù–ê
- Auth Service: –°–æ–∑–¥–∞–µ—Ç `sessionId = "abc123def456"`
- Auth Service ‚Üí Redis: `telegram_session:abc123def456 = { telegramId, username }`
- Auth Service ‚Üí Gateway: `{ url: "t.me/bot?start=abc123def456" }`

---

### **–®–∞–≥ 4: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ –±–æ—Ç–∞**

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É ‚Üí –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è Telegram
URL: t.me/bot?start=abc123def456
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ –±–æ—Ç–µ:**

```typescript
// Bot Service –ø–æ–ª—É—á–∞–µ—Ç /start abc123def456
bot.start(async (ctx) => {
  const sessionId = "abc123def456"; // –∏–∑ URL
  ctx.session.id = sessionId; // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ —Å–µ—Å—Å–∏—é

  await ctx.reply("–û—Ç–ø—Ä–∞–≤—å—Ç–µ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞", {
    keyboard: [["–û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–æ–º–µ—Ä"]],
  });
});
```

---

### **–®–∞–≥ 5: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–æ–º–µ—Ä**

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "–û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–æ–º–µ—Ä"
Telegram –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –±–æ—Ç—É: { phone_number: "+375297888192" }
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ –±–æ—Ç–µ:**

```typescript
bot.on("contact", async (ctx) => {
  const phone = "+375297888192";
  const sessionId = "abc123def456"; // –∏–∑ ctx.session.id

  // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ Auth Service
  await authClient.telegramComplete({ sessionId, phone });

  // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –≤–æ–∑–≤—Ä–∞—Ç–∞
  await ctx.reply("‚úÖ –ì–æ—Ç–æ–≤–æ!", {
    inline_keyboard: [
      [
        {
          text: "–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ —Å–∞–π—Ç",
          url: "https://site.com/auth/tg-finalize?session_id=abc123def456",
        },
      ],
    ],
  });
});
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–∞ –±—ç–∫–µ–Ω–¥–µ:**

- Bot ‚Üí Auth Service: `TelegramComplete({ sessionId, phone })`
- Auth Service ‚Üí Redis: –î–æ—Å—Ç–∞–µ—Ç `telegram_session:abc123def456`
- Auth Service: –ü–æ–ª—É—á–∞–µ—Ç `telegramId = "525366794"`
- Auth Service ‚Üí –ë–î: –ò—â–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ `phone = "+375297888192"`
- Auth Service ‚Üí –ë–î: –°–æ–∑–¥–∞–µ—Ç –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–µ—Å–ª–∏ –Ω–µ—Ç)
- Auth Service ‚Üí –ë–î: –û–±–Ω–æ–≤–ª—è–µ—Ç `telegramId = "525366794"`, `isPhoneVerified = true`
- Auth Service: –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç `{ accessToken, refreshToken }`
- Auth Service ‚Üí Redis: `telegram_tokens:abc123def456 = { accessToken, refreshToken }`
- Auth Service ‚Üí Redis: –£–¥–∞–ª—è–µ—Ç `telegram_session:abc123def456`
- Auth Service ‚Üí Bot: `{ sessionId: "abc123def456" }`

---

### **–®–∞–≥ 6: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –Ω–∞ —Å–∞–π—Ç**

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ —Å–∞–π—Ç"
–û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è: https://site.com/auth/tg-finalize?session_id=abc123def456
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ:**

```javascript
// –ü–æ–ª—É—á–∞–µ–º sessionId –∏–∑ URL
const params = new URLSearchParams(window.location.search);
const sessionId = params.get("session_id"); // "abc123def456"

// –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º —Ç–æ–∫–µ–Ω—ã
const response = await fetch("http://localhost:3000/auth/telegram/finalize", {
  method: "POST",
  headers: { "Content-Type": "application/json" },
  body: JSON.stringify({ sessionId }),
});

const { accessToken } = await response.json();

// –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ–∫–µ–Ω –∏ –∞–≤—Ç–æ—Ä–∏–∑—É–µ–º
localStorage.setItem("accessToken", accessToken);
redirectToHome();
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–∞ –±—ç–∫–µ–Ω–¥–µ:**

- Gateway ‚Üí Auth Service: `TelegramConsume({ sessionId: "abc123def456" })`
- Auth Service ‚Üí Redis: –î–æ—Å—Ç–∞–µ—Ç `telegram_tokens:abc123def456`
- Auth Service: –ü–æ–ª—É—á–∞–µ—Ç `{ accessToken, refreshToken }`
- Auth Service ‚Üí Redis: –£–¥–∞–ª—è–µ—Ç `telegram_tokens:abc123def456`
- Auth Service ‚Üí Gateway: `{ accessToken, refreshToken }`
- Gateway ‚Üí –§—Ä–æ–Ω—Ç–µ–Ω–¥: `{ accessToken }` + Cookie `refreshToken`

---

## ‚úÖ –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ö–µ–º–∞ –ø–æ—Ç–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Frontend ‚îÇ 1. GET /auth/telegram
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
     ‚îÇ
     ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê 2. TelegramInit()
‚îÇ Gateway  ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                      ‚îÇ
     ‚îÇ                            ‚ñº
     ‚îÇ                      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
     ‚îÇ 3. { url }           ‚îÇ   Auth   ‚îÇ
     ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§  Service ‚îÇ
     ‚îÇ                      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
     ‚îÇ
     ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Telegram ‚îÇ 4. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑—É–µ—Ç—Å—è
‚îÇ  OAuth   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
     ‚îÇ
     ‚îÇ 5. Redirect: #tgAuthResult=...
     ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Frontend ‚îÇ 6. POST /auth/telegram/verify
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    { tgAuthResult }
     ‚îÇ
     ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê 7. TelegramVerify()
‚îÇ Gateway  ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                      ‚îÇ
     ‚îÇ                            ‚ñº
     ‚îÇ                      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
     ‚îÇ                      ‚îÇ   Auth   ‚îÇ 8. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏ ‚úÖ
     ‚îÇ                      ‚îÇ  Service ‚îÇ 9. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ù–ï –Ω–∞–π–¥–µ–Ω
     ‚îÇ                      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
     ‚îÇ                           ‚îÇ
     ‚îÇ                           ‚îÇ 10. –°–æ–∑–¥–∞–µ—Ç sessionId
     ‚îÇ                           ‚ñº
     ‚îÇ                      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
     ‚îÇ                      ‚îÇ  Redis   ‚îÇ telegram_session:SESSION_ID
     ‚îÇ                      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
     ‚îÇ
     ‚îÇ 11. { url: "t.me/bot?start=SESSION_ID" }
     ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
     ‚îÇ
     ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Frontend ‚îÇ 12. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–Ω–æ–ø–∫—É "–ü–µ—Ä–µ–π—Ç–∏ –≤ Telegram"
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
     ‚îÇ
     ‚îÇ 13. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç
     ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Telegram ‚îÇ 14. /start SESSION_ID
‚îÇ   Bot    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
     ‚îÇ
     ‚îÇ 15. –ü—Ä–æ—Å–∏—Ç –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞
     ‚îÇ 16. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç
     ‚îÇ
     ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê 17. TelegramComplete()
‚îÇ   Bot    ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Service  ‚îÇ  { sessionId, phone } ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                      ‚îÇ
     ‚îÇ                            ‚ñº
     ‚îÇ                      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
     ‚îÇ                      ‚îÇ   Auth   ‚îÇ 18. –î–æ—Å—Ç–∞–µ—Ç –∏–∑ Redis
     ‚îÇ                      ‚îÇ  Service ‚îÇ 19. –°–æ–∑–¥–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
     ‚îÇ                      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò 20. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ç–æ–∫–µ–Ω—ã
     ‚îÇ                           ‚îÇ
     ‚îÇ                           ‚ñº
     ‚îÇ                      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
     ‚îÇ                      ‚îÇ  Redis   ‚îÇ telegram_tokens:SESSION_ID
     ‚îÇ                      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
     ‚îÇ
     ‚îÇ 21. { sessionId }
     ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
     ‚îÇ
     ‚îÇ 22. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–Ω–æ–ø–∫—É "–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ —Å–∞–π—Ç"
     ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Telegram ‚îÇ 23. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç
‚îÇ   Bot    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
     ‚îÇ
     ‚îÇ 24. Redirect: /auth/tg-finalize?session_id=SESSION_ID
     ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Frontend ‚îÇ 25. POST /auth/telegram/finalize
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    { sessionId }
     ‚îÇ
     ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê 26. TelegramConsume()
‚îÇ Gateway  ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                      ‚îÇ
     ‚îÇ                            ‚ñº
     ‚îÇ                      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
     ‚îÇ                      ‚îÇ   Auth   ‚îÇ 27. –î–æ—Å—Ç–∞–µ—Ç —Ç–æ–∫–µ–Ω—ã –∏–∑ Redis
     ‚îÇ                      ‚îÇ  Service ‚îÇ 28. –£–¥–∞–ª—è–µ—Ç –∏–∑ Redis
     ‚îÇ                      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
     ‚îÇ                           ‚îÇ
     ‚îÇ 29. { accessToken, refreshToken }
     ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
     ‚îÇ
     ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Frontend ‚îÇ 30. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ç–æ–∫–µ–Ω—ã
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò 31. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω! ‚úÖ
```

---

## üéì –ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è

### **1. –ü–æ—á–µ–º—É –¥–≤–∞ —ç—Ç–∞–ø–∞ (OAuth + Bot)?**

- **OAuth** - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å Telegram
- **Bot** - –ø–æ–ª—É—á–∞–µ—Ç –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ (OAuth –Ω–µ –¥–∞–µ—Ç –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞)

### **2. –ó–∞—á–µ–º sessionId?**

- –°–≤—è–∑—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –º–µ–∂–¥—É —Ä–∞–∑–Ω—ã–º–∏ —ç—Ç–∞–ø–∞–º–∏
- OAuth –∑–Ω–∞–µ—Ç `telegramId`, Bot –∑–Ω–∞–µ—Ç `phone`
- `sessionId` —Å–≤—è–∑—ã–≤–∞–µ—Ç –∏—Ö –≤–º–µ—Å—Ç–µ

### **3. –ü–æ—á–µ–º—É Redis, –∞ –Ω–µ –ë–î?**

- –î–∞–Ω–Ω—ã–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ (5 –º–∏–Ω—É—Ç –¥–ª—è —Å–µ—Å—Å–∏–∏, 2 –º–∏–Ω—É—Ç—ã –¥–ª—è —Ç–æ–∫–µ–Ω–æ–≤)
- Redis –±—ã—Å—Ç—Ä–µ–µ –ë–î –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ TTL (Time To Live)

### **4. –ü–æ—á–µ–º—É gRPC –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏?**

- –ë—ã—Å—Ç—Ä–µ–µ —á–µ–º HTTP/REST
- –°—Ç—Ä–æ–≥–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è (protobuf)
- –ë–∏–Ω–∞—Ä–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª (–º–µ–Ω—å—à–µ —Ç—Ä–∞—Ñ–∏–∫–∞)

### **5. –ß—Ç–æ —Ç–∞–∫–æ–µ accessToken –∏ refreshToken?**

- **accessToken** - –∫–æ—Ä–æ—Ç–∫–æ–∂–∏–≤—É—â–∏–π (15 –º–∏–Ω), –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è API –∑–∞–ø—Ä–æ—Å–æ–≤
- **refreshToken** - –¥–æ–ª–≥–æ–∂–∏–≤—É—â–∏–π (30 –¥–Ω–µ–π), –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è accessToken
- **refreshToken** —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ httpOnly cookie (–∑–∞—â–∏—Ç–∞ –æ—Ç XSS)

---

## üöÄ –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤–µ—Å—å —Ñ–ª–æ—É

### **1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã:**

```bash
# Terminal 1 - Auth Service
cd auth-service
yarn start:dev

# Terminal 2 - Gateway Service
cd gateway-service
yarn start:dev

# Terminal 3 - Bot Service
cd bot-service
yarn start:dev

# Terminal 4 - Redis
redis-server
```

### **2. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥:**

```
http://localhost:5173 (–∏–ª–∏ –≤–∞—à –ø–æ—Ä—Ç)
```

### **3. –ù–∞–∂–º–∏—Ç–µ "–í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Telegram":**

- –û—Ç–∫—Ä–æ–µ—Ç—Å—è Telegram OAuth
- –ù–∞–∂–º–∏—Ç–µ "–†–∞–∑—Ä–µ—à–∏—Ç—å"
- –í–µ—Ä–Ω–µ—Ç–µ—Å—å –Ω–∞ —Å–∞–π—Ç

### **4. –ï—Å–ª–∏ –Ω–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:**

- –£–≤–∏–¥–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–ü–µ—Ä–µ–π—Ç–∏ –≤ Telegram"
- –ù–∞–∂–º–∏—Ç–µ ‚Üí –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –±–æ—Ç
- –ù–∞–∂–º–∏—Ç–µ `/start`
- –ù–∞–∂–º–∏—Ç–µ "–û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–æ–º–µ—Ä"
- –ù–∞–∂–º–∏—Ç–µ "–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ —Å–∞–π—Ç"

### **5. –ì–æ—Ç–æ–≤–æ!**

- –í—ã –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ã ‚úÖ
- –¢–æ–∫–µ–Ω—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã
- –ú–æ–∂–µ—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Å–∞–π—Ç–æ–º

---

## üêõ –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### **–ü—Ä–æ–±–ª–µ–º–∞ 1: "Invalid Telegram session"**

**–ü—Ä–∏—á–∏–Ω–∞:** `sessionId` –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ Redis

**–†–µ—à–µ–Ω–∏–µ:**

- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Redis –∑–∞–ø—É—â–µ–Ω
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø—Ä–æ—à–ª–æ –º–µ–Ω—å—à–µ 5 –º–∏–Ω—É—Ç —Å –º–æ–º–µ–Ω—Ç–∞ OAuth
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∫–ª—é—á–∏ –≤ Redis –±–µ–∑ –ø—Ä–æ–±–µ–ª–æ–≤: `telegram_session:SESSION_ID`

---

### **–ü—Ä–æ–±–ª–µ–º–∞ 2: –ë–æ—Ç –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç sessionId**

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ –ø–µ—Ä–µ—à–ª–∏ –ø–æ —Å—Å—ã–ª–∫–µ —Å `?start=SESSION_ID`

**–†–µ—à–µ–Ω–∏–µ:**

- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –ø–æ —Å—Å—ã–ª–∫–µ –∏–∑ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –±–æ—Ç–∞: –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å `‚úÖ sessionId —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ —Å–µ—Å—Å–∏—é`

---

### **–ü—Ä–æ–±–ª–µ–º–∞ 3: –°–µ—Å—Å–∏—è –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –º–µ–∂–¥—É /start –∏ contact**

**–ü—Ä–∏—á–∏–Ω–∞:** Session middleware –≤ –ø–∞–º—è—Ç–∏, –±–æ—Ç –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–ª—Å—è

**–†–µ—à–µ–Ω–∏–µ:**

- –ù–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–π—Ç–µ –±–æ—Ç–∞ –º–µ–∂–¥—É —à–∞–≥–∞–º–∏
- –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Redis –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–µ—Å—Å–∏–π –±–æ—Ç–∞

---

### **–ü—Ä–æ–±–ª–µ–º–∞ 4: "Incorrect arguments passed" –≤ gRPC**

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤—ã–∑–æ–≤ gRPC –º–µ—Ç–æ–¥–∞

**–†–µ—à–µ–Ω–∏–µ:**

```typescript
// ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ:
const result = await authClient.telegramComplete(request);

// ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ:
const result = await new Promise((resolve, reject) => {
  authClient.telegramComplete(request, (err, response) => {
    if (err) reject(err);
    else resolve(response);
  });
});
```

---

## üìö –†–µ–∑—é–º–µ

**–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Telegram** - —ç—Ç–æ:

1. **OAuth** –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ª–∏—á–Ω–æ—Å—Ç–∏
2. **Bot** –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞
3. **Redis** –¥–ª—è —Å–≤—è–∑–∏ –º–µ–∂–¥—É —ç—Ç–∞–ø–∞–º–∏
4. **JWT —Ç–æ–∫–µ–Ω—ã** –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–∞ —Å–∞–π—Ç–µ

**–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç—Å—è:

- –ü—Ä–æ–≤–µ—Ä–∫–æ–π –ø–æ–¥–ø–∏—Å–∏ (HMAC-SHA256)
- –í—Ä–µ–º–µ–Ω–Ω—ã–º–∏ —Å–µ—Å—Å–∏—è–º–∏ (TTL –≤ Redis)
- httpOnly cookies –¥–ª—è refreshToken
- –û–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ç–æ–∫–µ–Ω–æ–≤

**–í–µ—Å—å –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–Ω–∏–º–∞–µ—Ç:**

- –î–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: **~5 —Å–µ–∫—É–Ω–¥**
- –î–ª—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: **~30 —Å–µ–∫—É–Ω–¥**

---
